import{a as q,b as H,d as Q}from"./chunk-JG2EF2JX.js";import{a as F}from"./chunk-SJCJM33I.js";import{b as k,c as O,f as W,i as B,j as L,k as j,n as A}from"./chunk-ACCF75FY.js";import{$a as _,$b as M,Ca as a,Da as S,Sa as p,Ua as l,Wa as T,Za as n,_a as i,ab as V,ac as P,bb as N,ca as w,cb as C,db as g,dc as D,eb as d,ka as v,la as u,mb as o,nb as x,ob as f,rb as h,sb as y,tb as I,vb as E}from"./chunk-2TFJQIGG.js";import{e as b}from"./chunk-DVOCWXDE.js";function J(e,s){e&1&&(n(0,"div",2)(1,"div",3)(2,"span",4),o(3,"Loading..."),i()()())}function K(e,s){e&1&&(n(0,"span",20),o(1,"Original"),i())}function X(e,s){if(e&1&&(n(0,"span",21),o(1),i()),e&2){let t=d().$implicit;a(),f("v",t.level,"")}}function Y(e,s){e&1&&_(0,"i",22)}function Z(e,s){if(e&1&&(V(0),n(1,"div",13)(2,"div",14),_(3,"i",15),n(4,"div")(5,"div",16),o(6),i(),p(7,K,2,0,"span",17)(8,X,2,1,"span",18),i()()(),p(9,Y,1,0,"i",19),N()),e&2){let t=s.$implicit,m=s.index,r=d(2);a(),T("ring-primary",t.part.id===r.partId),a(5),x(t.part.part_number),a(),l("ngIf",t.level===0),a(),l("ngIf",t.level>0),a(),l("ngIf",m<r.chain.length-1)}}function $(e,s){e&1&&(n(0,"span",35),o(1,"Original"),i())}function tt(e,s){if(e&1&&(n(0,"span",36),o(1),i()),e&2){let t=d().$implicit;a(),f("Modified v",t.level,"")}}function et(e,s){e&1&&(n(0,"span",37),o(1,"Current"),i())}function it(e,s){if(e&1&&(n(0,"div",38),o(1),i()),e&2){let t=d().$implicit;a(),f(" ",t.part.description," ")}}function nt(e,s){if(e&1&&(n(0,"div",39),o(1),i()),e&2){let t=d().$implicit;a(),f(" \u{1F4CD} ",t.part.default_location," ")}}function at(e,s){if(e&1&&(n(0,"div",40),o(1),i()),e&2){let t=d().$implicit;a(),f(" Note: ",t.part.notes," ")}}function ot(e,s){if(e&1&&(n(0,"div",23)(1,"div",24)(2,"div",25),_(3,"i",26),n(4,"div")(5,"div",27)(6,"span",28),o(7),i(),p(8,$,2,0,"span",29)(9,tt,2,1,"span",30)(10,et,2,0,"span",31),i(),p(11,it,2,1,"div",32),i()(),p(12,nt,2,1,"div",33),i(),p(13,at,2,1,"div",34),i()),e&2){let t=s.$implicit,m=d(2);T("bg-light",t.part.id===m.partId)("border-primary",t.part.id===m.partId),a(7),x(t.part.part_number),a(),l("ngIf",t.level===0),a(),l("ngIf",t.level>0),a(),l("ngIf",t.part.id===m.partId),a(),l("ngIf",t.part.description),a(),l("ngIf",t.part.default_location),a(),l("ngIf",t.part.notes)}}function rt(e,s){if(e&1&&(n(0,"div",5)(1,"div",6)(2,"h5",7),o(3,"Modification History"),i()(),n(4,"div",8)(5,"div",9),p(6,Z,10,6,"ng-container",10),i(),n(7,"div",11),p(8,ot,14,11,"div",12),i()()()),e&2){let t=d();a(6),l("ngForOf",t.chain),a(2),l("ngForOf",t.chain)}}var R=(()=>{class e{constructor(t){this.partsService=t,this.partId="",this.chain=[],this.loading=!0}ngOnInit(){return b(this,null,function*(){this.partId&&(yield this.loadChain())})}loadChain(){return b(this,null,function*(){this.loading=!0,this.chain=yield this.partsService.getModificationChain(this.partId),this.loading=!1})}static{this.\u0275fac=function(m){return new(m||e)(S(F))}}static{this.\u0275cmp=w({type:e,selectors:[["app-modification-chain"]],inputs:{partId:"partId"},standalone:!0,features:[E],decls:2,vars:2,consts:[["class","text-center py-4",4,"ngIf"],["class","card",4,"ngIf"],[1,"text-center","py-4"],["role","status",1,"spinner-border","spinner-border-sm","text-primary"],[1,"visually-hidden"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"card-body"],[1,"d-flex","align-items-center","gap-2","flex-wrap","mb-4"],[4,"ngFor","ngForOf"],[1,"list-group"],["class","list-group-item",3,"bg-light","border-primary",4,"ngFor","ngForOf"],[1,"border","rounded","p-2"],[1,"d-flex","align-items-center","gap-2"],[1,"bi","bi-box-seam","text-muted"],[1,"small","font-monospace","fw-medium"],["class","badge bg-primary mt-1",4,"ngIf"],["class","badge bg-info text-dark mt-1",4,"ngIf"],["class","bi bi-arrow-right text-muted",4,"ngIf"],[1,"badge","bg-primary","mt-1"],[1,"badge","bg-info","text-dark","mt-1"],[1,"bi","bi-arrow-right","text-muted"],[1,"list-group-item"],[1,"d-flex","justify-content-between","align-items-start"],[1,"d-flex","align-items-start","gap-2"],[1,"bi","bi-box-seam","text-muted","mt-1"],[1,"d-flex","align-items-center","gap-2","flex-wrap"],[1,"font-monospace","fw-medium"],["class","badge bg-primary",4,"ngIf"],["class","badge bg-info text-dark",4,"ngIf"],["class","badge bg-success",4,"ngIf"],["class","small text-muted mt-1",4,"ngIf"],["class","text-muted small",4,"ngIf"],["class","small text-muted mt-2 ps-4",4,"ngIf"],[1,"badge","bg-primary"],[1,"badge","bg-info","text-dark"],[1,"badge","bg-success"],[1,"small","text-muted","mt-1"],[1,"text-muted","small"],[1,"small","text-muted","mt-2","ps-4"]],template:function(m,r){m&1&&p(0,J,4,0,"div",0)(1,rt,9,2,"div",1),m&2&&(l("ngIf",r.loading),a(),l("ngIf",!r.loading&&r.chain.length>1))},dependencies:[D,M,P],styles:[".ring-primary[_ngcontent-%COMP%]{box-shadow:0 0 0 2px var(--bs-primary)}"]})}}return e})();function lt(e,s){e&1&&(n(0,"div",7)(1,"div",8)(2,"span",9),o(3,"Loading..."),i()()())}function dt(e,s){if(e&1){let t=C();n(0,"button",21),g("click",function(){v(t);let r=d(3);return u(r.isEditing=!0)}),_(1,"i",22),o(2," Edit "),i()}}function st(e,s){if(e&1){let t=C();n(0,"div",23)(1,"button",24),g("click",function(){v(t);let r=d(3);return u(r.cancel())}),_(2,"i",25),o(3," Cancel "),i(),n(4,"button",26),g("click",function(){v(t);let r=d(3);return u(r.save())}),_(5,"i",27),o(6," Save "),i()()}if(e&2){let t=d(3);a(4),l("disabled",!t.editForm.part_number.trim())}}function mt(e,s){if(e&1&&(n(0,"div",18),p(1,dt,3,0,"button",19)(2,st,7,1,"div",20),i()),e&2){let t=d(2);a(),l("ngIf",!t.isEditing),a(),l("ngIf",t.isEditing)}}function pt(e,s){if(e&1){let t=C();n(0,"div")(1,"div",28)(2,"div",29)(3,"label",30),o(4,"Part Number *"),i(),n(5,"input",31),I("ngModelChange",function(r){v(t);let c=d(2);return y(c.editForm.part_number,r)||(c.editForm.part_number=r),u(r)}),i()(),n(6,"div",29)(7,"label",30),o(8,"Classification"),i(),n(9,"select",32),I("ngModelChange",function(r){v(t);let c=d(2);return y(c.editForm.classification_type,r)||(c.editForm.classification_type=r),u(r)}),n(10,"option",33),o(11,"Select classification"),i(),n(12,"option",34),o(13,"Purchased"),i(),n(14,"option",35),o(15,"Manufactured"),i(),n(16,"option",36),o(17,"Assembly"),i(),n(18,"option",37),o(19,"Modified"),i()()(),n(20,"div",38)(21,"label",30),o(22,"Description"),i(),n(23,"input",31),I("ngModelChange",function(r){v(t);let c=d(2);return y(c.editForm.description,r)||(c.editForm.description=r),u(r)}),i()(),n(24,"div",38)(25,"label",30),o(26,"Default Location"),i(),n(27,"input",31),I("ngModelChange",function(r){v(t);let c=d(2);return y(c.editForm.default_location,r)||(c.editForm.default_location=r),u(r)}),i()(),n(28,"div",38)(29,"label",30),o(30,"Notes"),i(),n(31,"textarea",39),I("ngModelChange",function(r){v(t);let c=d(2);return y(c.editForm.notes,r)||(c.editForm.notes=r),u(r)}),i()()()()}if(e&2){let t=d(2);a(5),h("ngModel",t.editForm.part_number),a(4),h("ngModel",t.editForm.classification_type),a(14),h("ngModel",t.editForm.description),a(4),h("ngModel",t.editForm.default_location),a(4),h("ngModel",t.editForm.notes)}}function ct(e,s){if(e&1&&(n(0,"div",44)(1,"span",45),o(2,"Description: "),i(),n(3,"span"),o(4),i()()),e&2){let t=d(3);a(4),x(t.part.description)}}function _t(e,s){if(e&1&&(n(0,"div",44)(1,"span",45),o(2,"Location: "),i(),n(3,"span",46),o(4),i()()),e&2){let t=d(3);a(4),f("\u{1F4CD} ",t.part.default_location,"")}}function ft(e,s){if(e&1&&(n(0,"div",44)(1,"span",45),o(2,"Notes: "),i(),n(3,"span"),o(4),i()()),e&2){let t=d(3);a(4),x(t.part.notes)}}function vt(e,s){if(e&1&&(n(0,"div")(1,"div",40)(2,"h4",41),o(3),i(),_(4,"app-classification-badge",42),i(),p(5,ct,5,1,"div",43)(6,_t,5,1,"div",43)(7,ft,5,1,"div",43),i()),e&2){let t=d(2);a(3),x(t.part.part_number),a(),l("classification",t.part.classification_type),a(),l("ngIf",t.part.description),a(),l("ngIf",t.part.default_location),a(),l("ngIf",t.part.notes)}}function ut(e,s){if(e&1&&(n(0,"span",52),o(1),i()),e&2){let t=d(3);a(),f(" (",t.part.base_part.description,") ")}}function xt(e,s){if(e&1&&(n(0,"div",11)(1,"div",12)(2,"h6",13),o(3,"Based On"),i()(),n(4,"div",14)(5,"div",47),_(6,"i",48),n(7,"span",49),o(8),i(),_(9,"i",50),n(10,"span",49),o(11),i(),p(12,ut,2,1,"span",51),i()()()),e&2){let t=d(2);a(8),x(t.part.base_part.part_number),a(3),x(t.part.part_number),a(),l("ngIf",t.part.base_part.description)}}function gt(e,s){if(e&1&&(n(0,"div"),_(1,"app-modification-chain",53),i()),e&2){let t=d(2);a(),l("partId",t.partId)}}function bt(e,s){if(e&1){let t=C();n(0,"div",54)(1,"app-bom-editor",55),g("update",function(){v(t);let r=d(2);return u(r.loadPart())}),i()()}if(e&2){let t=d(2);a(),l("partId",t.partId)}}function Ct(e,s){if(e&1&&(n(0,"div",64),o(1),i()),e&2){let t=d().$implicit;a(),f(" ",t.part.description," ")}}function ht(e,s){if(e&1&&(n(0,"span",65),o(1),i()),e&2){let t=d().$implicit;a(),f("(",t.reference_designator,")")}}function yt(e,s){if(e&1&&(n(0,"div",59)(1,"div",60)(2,"div",47),_(3,"i",48),n(4,"div")(5,"div",49),o(6),i(),p(7,Ct,2,1,"div",61),i()(),n(8,"div",62),o(9),p(10,ht,2,1,"span",63),i()()()),e&2){let t=s.$implicit;a(6),x(t.part.part_number),a(),l("ngIf",t.part.description),a(2),f(" Qty: ",t.quantity," "),a(),l("ngIf",t.reference_designator)}}function It(e,s){if(e&1&&(n(0,"div",56)(1,"div",12)(2,"h6",13),o(3),i()(),n(4,"div",14)(5,"div",57),p(6,yt,11,4,"div",58),i()()()),e&2){let t=d(2);a(3),f("Where Used (",t.part.used_in.length,")"),a(3),l("ngForOf",t.part.used_in)}}function St(e,s){if(e&1&&(n(0,"div"),p(1,mt,3,2,"div",10),n(2,"div",11)(3,"div",12)(4,"h6",13),o(5,"Part Information"),i()(),n(6,"div",14),p(7,pt,32,5,"div",5)(8,vt,8,5,"div",5),i()(),p(9,xt,13,3,"div",15)(10,gt,2,1,"div",5)(11,bt,2,1,"div",16)(12,It,7,2,"div",17),i()),e&2){let t=d();a(),l("ngIf",!t.isNew),a(6),l("ngIf",t.isEditing),a(),l("ngIf",!t.isEditing&&t.part),a(),l("ngIf",!t.isNew&&t.isModified&&(t.part==null?null:t.part.base_part)),a(),l("ngIf",!t.isNew&&(t.isModified||(t.part==null?null:t.part.modifications)&&t.part.modifications.length>0)),a(),l("ngIf",!t.isNew&&t.isAssembly),a(),l("ngIf",!t.isNew&&(t.part==null?null:t.part.used_in)&&t.part.used_in.length>0)}}function wt(e,s){if(e&1){let t=C();n(0,"div",66)(1,"button",67),g("click",function(){v(t);let r=d();return u(r.activeModal.dismiss())}),o(2,"Cancel"),i(),n(3,"button",68),g("click",function(){v(t);let r=d();return u(r.save())}),o(4," Create Part "),i()()}if(e&2){let t=d();a(3),l("disabled",!t.editForm.part_number.trim())}}var Lt=(()=>{class e{constructor(t,m){this.activeModal=t,this.partsService=m,this.isNew=!1,this.part=null,this.loading=!0,this.isEditing=!1,this.editForm={part_number:"",description:"",classification_type:"",default_location:"",notes:""}}ngOnInit(){return b(this,null,function*(){this.isNew?(this.isEditing=!0,this.loading=!1):this.partId&&(yield this.loadPart())})}loadPart(){return b(this,null,function*(){this.loading=!0,this.partId&&(this.part=yield this.partsService.getPartWithRelationships(this.partId),this.part&&(this.editForm={part_number:this.part.part_number,description:this.part.description||"",classification_type:this.part.classification_type||"",default_location:this.part.default_location||"",notes:this.part.notes||""})),this.loading=!1})}save(){return b(this,null,function*(){this.isNew?(yield this.partsService.createPart({part_number:this.editForm.part_number.trim(),description:this.editForm.description.trim()||null,classification_type:this.editForm.classification_type||null,is_assembly:!1,is_modified:!1,default_location:this.editForm.default_location.trim()||null,base_part_id:null,notes:this.editForm.notes.trim()||null}),this.activeModal.close()):this.partId&&(yield this.partsService.updatePart(this.partId,{part_number:this.editForm.part_number.trim(),description:this.editForm.description.trim()||null,classification_type:this.editForm.classification_type||null,default_location:this.editForm.default_location.trim()||null,notes:this.editForm.notes.trim()||null}),yield this.loadPart(),this.isEditing=!1)})}cancel(){this.isNew?this.activeModal.dismiss():(this.isEditing=!1,this.part&&(this.editForm={part_number:this.part.part_number,description:this.part.description||"",classification_type:this.part.classification_type||"",default_location:this.part.default_location||"",notes:this.part.notes||""}))}get isAssembly(){return this.part?.is_assembly===!0}get isModified(){return this.part?.is_modified===!0}getClassificationBadgeClass(t){return{purchased:"badge bg-primary",manufactured:"badge bg-warning text-dark"}[t]}static{this.\u0275fac=function(m){return new(m||e)(S(H),S(F))}}static{this.\u0275cmp=w({type:e,selectors:[["app-part-detail"]],inputs:{partId:"partId",isNew:"isNew"},standalone:!0,features:[E],decls:8,vars:4,consts:[[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body",2,"max-height","80vh","overflow-y","auto"],["class","text-center py-5",4,"ngIf"],[4,"ngIf"],["class","modal-footer",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["class","d-flex justify-content-end mb-3",4,"ngIf"],[1,"card","mb-3"],[1,"card-header"],[1,"mb-0"],[1,"card-body"],["class","card mb-3",4,"ngIf"],["class","mt-3",4,"ngIf"],["class","card mt-3",4,"ngIf"],[1,"d-flex","justify-content-end","mb-3"],["class","btn btn-sm btn-outline-secondary",3,"click",4,"ngIf"],["class","btn-group btn-group-sm",4,"ngIf"],[1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"bi","bi-pencil","me-1"],[1,"btn-group","btn-group-sm"],[1,"btn","btn-outline-secondary",3,"click"],[1,"bi","bi-x","me-1"],[1,"btn","btn-primary",3,"click","disabled"],[1,"bi","bi-check-lg","me-1"],[1,"row","g-3"],[1,"col-md-6"],[1,"form-label"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],["value","purchased"],["value","manufactured"],["value","assembly"],["value","modified"],[1,"col-12"],["rows","3",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","align-items-center","gap-2","mb-2"],[1,"mb-0","font-monospace"],[3,"classification"],["class","mb-2",4,"ngIf"],[1,"mb-2"],[1,"text-muted"],[1,"fw-medium"],[1,"d-flex","align-items-center","gap-2"],[1,"bi","bi-box-seam","text-muted"],[1,"font-monospace","fw-medium"],[1,"bi","bi-arrow-right","text-muted"],["class","text-muted small ms-2",4,"ngIf"],[1,"text-muted","small","ms-2"],[3,"partId"],[1,"mt-3"],[3,"update","partId"],[1,"card","mt-3"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"d-flex","justify-content-between","align-items-center"],["class","small text-muted",4,"ngIf"],[1,"text-muted","small"],["class","ms-2",4,"ngIf"],[1,"small","text-muted"],[1,"ms-2"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"]],template:function(m,r){m&1&&(n(0,"div",0)(1,"h5",1),o(2),i(),n(3,"button",2),g("click",function(){return r.activeModal.dismiss()}),i()(),n(4,"div",3),p(5,lt,4,0,"div",4)(6,St,13,7,"div",5),i(),p(7,wt,5,1,"div",6)),m&2&&(a(2),x(r.isNew?"Create New Part":"Part Details"),a(3),l("ngIf",r.loading),a(),l("ngIf",!r.loading),a(),l("ngIf",r.isNew))},dependencies:[D,M,P,A,L,j,k,B,O,W,q,Q,R],encapsulation:2})}}return e})();export{Lt as a};
