import{a as nt}from"./chunk-HWGX3DK4.js";import{b as at}from"./chunk-X6NM5MJK.js";import{a as rt,b as ot}from"./chunk-XRYMOE7L.js";import{a as st}from"./chunk-6CNJLGU4.js";import{f as tt,i as et}from"./chunk-SJKOT4HS.js";import{$a as m,$b as V,Ca as a,Cb as Z,Da as k,Db as J,Sa as g,T as Y,Ta as u,Ua as d,Va as H,Wa as M,Xa as A,Y as R,Za as r,_a as o,_b as K,ab as q,ac as B,bb as X,ca as E,cb as T,cc as Q,db as P,dc as F,eb as p,ic as it,ka as y,la as C,ma as _,mb as l,nb as O,ob as v,pb as S,vb as L,wb as U,xb as G}from"./chunk-2TFJQIGG.js";import{e as I}from"./chunk-DVOCWXDE.js";function ut(i,s){if(i&1&&(_(),m(0,"line",9)),i&2){let t=s.$implicit,n=p(2);u("x1",n.padding)("y1",t)("x2",n.width-n.padding)("y2",t)}}function _t(i,s){if(i&1&&(_(),r(0,"text",13),l(1),o()),i&2){let t=p(),n=t.$implicit,e=t.index,c=p(2);u("x",c.getBarX(e)+c.barWidth/2)("y",c.getBarY(n.value)-8),a(),v(" ",n.value," ")}}function vt(i,s){if(i&1){let t=T();_(),r(0,"g")(1,"rect",10),P("mouseenter",function(){let e=y(t).index,c=p(2);return C(c.hoveredIndex=e)})("mouseleave",function(){y(t);let e=p(2);return C(e.hoveredIndex=null)}),r(2,"title"),l(3),o()(),g(4,_t,2,3,"text",11),r(5,"text",12),l(6),o()()}if(i&2){let t=s.$implicit,n=s.index,e=p(2);a(),u("x",e.getBarX(n))("y",e.getBarY(t.value))("width",e.barWidth)("height",e.getBarHeight(t.value))("fill",t.color||"url(#barGradient)"),a(2),S("",t.label,": ",t.value,""),a(),d("ngIf",e.showValues&&t.value>0),a(),u("x",e.getBarX(n)+e.barWidth/2)("y",e.height-e.padding+20),a(),v(" ",t.label," ")}}function ft(i,s){if(i&1&&(_(),r(0,"g"),g(1,ut,1,4,"line",6)(2,vt,7,11,"g",7),m(3,"line",8)(4,"line",8),o()),i&2){let t=p();a(),d("ngForOf",t.gridLines),a(),d("ngForOf",t.dataPoints),a(),u("x1",t.padding)("y1",t.padding)("x2",t.padding)("y2",t.height-t.padding),a(),u("x1",t.padding)("y1",t.height-t.padding)("x2",t.width-t.padding)("y2",t.height-t.padding)}}function xt(i,s){if(i&1&&(_(),m(0,"line",9)),i&2){let t=s.$implicit,n=p(2);u("x1",t)("y1",n.paddingTop)("x2",t)("y2",n.height-n.paddingBottom)}}function bt(i,s){if(i&1&&(_(),r(0,"text",16),l(1),o()),i&2){let t=p(),n=t.$implicit,e=t.index,c=p(2);u("x",c.paddingLeft+c.getHorizontalBarWidth(n.value)+8)("y",c.getHorizontalBarY(e)+c.horizontalBarHeight/2),a(),v(" ",n.value," ")}}function yt(i,s){if(i&1){let t=T();_(),r(0,"g")(1,"rect",10),P("mouseenter",function(){let e=y(t).index,c=p(2);return C(c.hoveredIndex=e)})("mouseleave",function(){y(t);let e=p(2);return C(e.hoveredIndex=null)}),r(2,"title"),l(3),o()(),g(4,bt,2,3,"text",14),r(5,"text",15),l(6),o()()}if(i&2){let t=s.$implicit,n=s.index,e=p(2);a(),u("x",e.paddingLeft)("y",e.getHorizontalBarY(n))("width",e.getHorizontalBarWidth(t.value))("height",e.horizontalBarHeight)("fill",t.color||"url(#barGradient)"),a(2),S("",t.label,": ",t.value,""),a(),d("ngIf",e.showValues&&t.value>0),a(),u("x",e.paddingLeft-10)("y",e.getHorizontalBarY(n)+e.horizontalBarHeight/2),a(),v(" ",t.label," ")}}function Ct(i,s){if(i&1&&(_(),r(0,"g"),g(1,xt,1,4,"line",6)(2,yt,7,11,"g",7),m(3,"line",8),o()),i&2){let t=p();a(),d("ngForOf",t.gridLinesHorizontal),a(),d("ngForOf",t.dataPoints),a(),u("x1",t.paddingLeft)("y1",t.height-t.paddingBottom)("x2",t.width-t.paddingRight)("y2",t.height-t.paddingBottom)}}var lt=(()=>{class i{constructor(){this.data=[],this.orientation="vertical",this.showValues=!0,this.height=300,this.width=600,this.hoveredIndex=null,this.padding=50,this.paddingLeft=100,this.paddingRight=60,this.paddingTop=20,this.paddingBottom=40}get viewBox(){return`0 0 ${this.width} ${this.height}`}get dataPoints(){return this.data.length>0?this.data:[]}get maxValue(){let t=Math.max(...this.dataPoints.map(n=>n.value),0);return t>0?t:10}get chartHeight(){return this.height-this.padding*2}get chartWidth(){return this.width-this.padding*2}get horizontalChartWidth(){return this.width-this.paddingLeft-this.paddingRight}get horizontalChartHeight(){return this.height-this.paddingTop-this.paddingBottom}get barWidth(){let t=this.dataPoints.length||1;return this.chartWidth/t*(1-.2)}get barSpacing(){let t=this.dataPoints.length||1;return this.chartWidth/t}get horizontalBarHeight(){let t=this.dataPoints.length||1;return this.horizontalChartHeight/t*(1-.3)}get horizontalBarSpacing(){let t=this.dataPoints.length||1;return this.horizontalChartHeight/t}get gridLines(){let t=[];for(let e=0;e<=5;e++)t.push(this.padding+this.chartHeight/5*e);return t}get gridLinesHorizontal(){let t=[];for(let e=0;e<=5;e++)t.push(this.paddingLeft+this.horizontalChartWidth/5*e);return t}getBarX(t){return this.padding+this.barSpacing*t+(this.barSpacing-this.barWidth)/2}getBarY(t){let n=t/this.maxValue;return this.padding+this.chartHeight*(1-n)}getBarHeight(t){let n=t/this.maxValue;return this.chartHeight*n}getHorizontalBarY(t){return this.paddingTop+this.horizontalBarSpacing*t+(this.horizontalBarSpacing-this.horizontalBarHeight)/2}getHorizontalBarWidth(t){let n=t/this.maxValue;return this.horizontalChartWidth*n}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=E({type:i,selectors:[["app-bar-chart"]],inputs:{data:"data",orientation:"orientation",showValues:"showValues",height:"height",width:"width"},standalone:!0,features:[L],decls:8,vars:5,consts:[[1,"bar-chart-container"],["preserveAspectRatio","xMidYMid meet",1,"bar-chart-svg"],["id","barGradient","x1","0%","y1","0%","x2","0%","y2","100%"],["offset","0%",2,"stop-color","var(--brand-primary)","stop-opacity","1"],["offset","100%",2,"stop-color","var(--brand-primary-hover)","stop-opacity","1"],[4,"ngIf"],["stroke","var(--surface-border)","stroke-width","1","opacity","0.5",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["stroke","var(--surface-border-strong)","stroke-width","2"],["stroke","var(--surface-border)","stroke-width","1","opacity","0.5"],["rx","4",1,"bar",3,"mouseenter","mouseleave"],["text-anchor","middle","class","value-label",4,"ngIf"],["text-anchor","middle",1,"axis-label"],["text-anchor","middle",1,"value-label"],["alignment-baseline","middle","class","value-label",4,"ngIf"],["text-anchor","end","alignment-baseline","middle",1,"axis-label"],["alignment-baseline","middle",1,"value-label"]],template:function(n,e){n&1&&(r(0,"div",0),_(),r(1,"svg",1)(2,"defs")(3,"linearGradient",2),m(4,"stop",3)(5,"stop",4),o()(),g(6,ft,5,10,"g",5)(7,Ct,4,6,"g",5),o()()),n&2&&(M("horizontal",e.orientation==="horizontal"),a(),u("viewBox",e.viewBox),a(5),d("ngIf",e.orientation==="vertical"),a(),d("ngIf",e.orientation==="horizontal"))},dependencies:[F,V,B],styles:[".bar-chart-container[_ngcontent-%COMP%]{width:100%;height:100%;min-height:250px}.bar-chart-container.horizontal[_ngcontent-%COMP%]{min-height:200px}.bar-chart-svg[_ngcontent-%COMP%]{width:100%;height:100%}.bar[_ngcontent-%COMP%]{transition:opacity .15s ease;cursor:pointer}.bar[_ngcontent-%COMP%]:hover{opacity:.8}.value-label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;fill:var(--text-primary)}.axis-label[_ngcontent-%COMP%]{font-size:11px;fill:var(--text-muted);font-weight:500}"]})}}return i})();function St(i,s){if(i&1&&(_(),m(0,"line",13)),i&2){let t=s.$implicit,n=p();u("x1",n.paddingLeft)("y1",t)("x2",n.width-n.paddingRight)("y2",t)}}function wt(i,s){if(i&1&&(_(),r(0,"text",14),l(1),o()),i&2){let t=s.$implicit,n=s.index,e=p();u("x",e.paddingLeft-10)("y",t+4),a(),v(" ",e.getYLabel(n)," ")}}function Dt(i,s){if(i&1&&(_(),m(0,"path",15)),i&2){let t=p();u("d",t.areaPath)}}function It(i,s){if(i&1&&(_(),m(0,"path",16)),i&2){let t=p();u("d",t.linePath)}}function kt(i,s){if(i&1&&(_(),m(0,"circle",19)),i&2){let t=p().$implicit;u("cx",t.x)("cy",t.y)}}function Tt(i,s){if(i&1){let t=T();_(),r(0,"g")(1,"circle",17),P("mouseenter",function(){let e=y(t).index,c=p();return C(c.hoveredIndex=e)})("mouseleave",function(){y(t);let e=p();return C(e.hoveredIndex=null)}),r(2,"title"),l(3),o()(),g(4,kt,1,2,"circle",18),o()}if(i&2){let t=s.$implicit,n=s.index,e=p();a(),u("cx",t.x)("cy",t.y),a(2),S("",e.dataPoints[n].label,": ",e.dataPoints[n].value,"%"),a(),d("ngIf",e.hoveredIndex===n)}}function Pt(i,s){if(i&1&&(_(),r(0,"text",21),l(1),o()),i&2){let t=p(),n=t.$implicit,e=t.index,c=p();u("x",n.x)("y",c.height-c.paddingBottom+20),a(),v(" ",c.getXLabel(e)," ")}}function Ot(i,s){if(i&1&&(_(),q(0),g(1,Pt,2,3,"text",20),X()),i&2){let t=s.index,n=p();a(),d("ngIf",t%2===0||t===n.chartPoints.length-1)}}var ct=(()=>{class i{constructor(){this.data=[],this.height=300,this.width=600,this.minValue=0,this.maxValue=100,this.hoveredIndex=null,this.paddingLeft=50,this.paddingRight=30,this.paddingTop=30,this.paddingBottom=40}get viewBox(){return`0 0 ${this.width} ${this.height}`}get dataPoints(){return this.data.length>0?this.data:[]}get chartWidth(){return this.width-this.paddingLeft-this.paddingRight}get chartHeight(){return this.height-this.paddingTop-this.paddingBottom}get yGridLines(){let t=[];for(let e=0;e<=5;e++)t.push(this.paddingTop+this.chartHeight/5*e);return t}get chartPoints(){return this.dataPoints.length===0?[]:this.dataPoints.map((t,n)=>{let e=this.paddingLeft+this.chartWidth/(this.dataPoints.length-1||1)*n,c=(t.value-this.minValue)/(this.maxValue-this.minValue),h=this.paddingTop+this.chartHeight*(1-c);return{x:e,y:h}})}get linePath(){if(this.chartPoints.length===0)return"";let t=`M ${this.chartPoints[0].x} ${this.chartPoints[0].y}`;for(let n=1;n<this.chartPoints.length;n++){let e=this.chartPoints[n];t+=` L ${e.x} ${e.y}`}return t}get areaPath(){if(this.chartPoints.length===0)return"";let t=this.height-this.paddingBottom,n=`M ${this.chartPoints[0].x} ${t}`;n+=` L ${this.chartPoints[0].x} ${this.chartPoints[0].y}`;for(let c=1;c<this.chartPoints.length;c++){let h=this.chartPoints[c];n+=` L ${h.x} ${h.y}`}let e=this.chartPoints[this.chartPoints.length-1];return n+=` L ${e.x} ${t}`,n+=" Z",n}getYLabel(t){let e=this.maxValue-(this.maxValue-this.minValue)/5*t;return Math.round(e)+"%"}getXLabel(t){if(t>=this.dataPoints.length)return"";let n=this.dataPoints[t].label,e=n.split("-");return e.length===3?`${e[1]}/${e[2]}`:n}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=E({type:i,selectors:[["app-line-chart"]],inputs:{data:"data",height:"height",width:"width",minValue:"minValue",maxValue:"maxValue"},standalone:!0,features:[L],decls:16,vars:15,consts:[[1,"line-chart-container"],["preserveAspectRatio","xMidYMid meet",1,"line-chart-svg"],["id","areaGradient","x1","0%","y1","0%","x2","0%","y2","100%"],["offset","0%",2,"stop-color","var(--brand-primary)","stop-opacity","0.3"],["offset","100%",2,"stop-color","var(--brand-primary)","stop-opacity","0.05"],[1,"grid"],["stroke","var(--surface-border)","stroke-width","1","opacity","0.5",4,"ngFor","ngForOf"],["text-anchor","end","class","grid-label",4,"ngFor","ngForOf"],["fill","url(#areaGradient)","opacity","0.8",4,"ngIf"],["fill","none","stroke","var(--brand-primary)","stroke-width","3","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"x-axis-labels"],["stroke","var(--surface-border-strong)","stroke-width","2"],["stroke","var(--surface-border)","stroke-width","1","opacity","0.5"],["text-anchor","end",1,"grid-label"],["fill","url(#areaGradient)","opacity","0.8"],["fill","none","stroke","var(--brand-primary)","stroke-width","3","stroke-linecap","round","stroke-linejoin","round"],["r","5","fill","var(--brand-primary)","stroke","var(--surface-card)","stroke-width","2",1,"data-point",3,"mouseenter","mouseleave"],["r","8","fill","none","stroke","var(--brand-primary)","stroke-width","2","opacity","0.5",4,"ngIf"],["r","8","fill","none","stroke","var(--brand-primary)","stroke-width","2","opacity","0.5"],["text-anchor","middle","class","axis-label",4,"ngIf"],["text-anchor","middle",1,"axis-label"]],template:function(n,e){n&1&&(r(0,"div",0),_(),r(1,"svg",1)(2,"defs")(3,"linearGradient",2),m(4,"stop",3)(5,"stop",4),o()(),r(6,"g",5),g(7,St,1,4,"line",6)(8,wt,2,3,"text",7),o(),g(9,Dt,1,1,"path",8)(10,It,1,1,"path",9)(11,Tt,5,5,"g",10),r(12,"g",11),g(13,Ot,2,1,"ng-container",10),o(),m(14,"line",12)(15,"line",12),o()()),n&2&&(a(),u("viewBox",e.viewBox),a(6),d("ngForOf",e.yGridLines),a(),d("ngForOf",e.yGridLines),a(),d("ngIf",e.areaPath),a(),d("ngIf",e.linePath),a(),d("ngForOf",e.chartPoints),a(2),d("ngForOf",e.chartPoints),a(),u("x1",e.paddingLeft)("y1",e.paddingTop)("x2",e.paddingLeft)("y2",e.height-e.paddingBottom),a(),u("x1",e.paddingLeft)("y1",e.height-e.paddingBottom)("x2",e.width-e.paddingRight)("y2",e.height-e.paddingBottom))},dependencies:[F,V,B],styles:[".line-chart-container[_ngcontent-%COMP%]{width:100%;height:100%;min-height:250px}.line-chart-svg[_ngcontent-%COMP%]{width:100%;height:100%}.data-point[_ngcontent-%COMP%]{transition:r .15s ease;cursor:pointer}.data-point[_ngcontent-%COMP%]:hover{r:7}.grid-label[_ngcontent-%COMP%], .axis-label[_ngcontent-%COMP%]{font-size:11px;fill:var(--text-muted);font-weight:500}"]})}}return i})();var pt=(()=>{class i{constructor(t){this.supabase=t}getLast7DaysPickActivity(){return I(this,null,function*(){try{let t=new Date,n=new Date(t);n.setDate(t.getDate()-6),n.setHours(0,0,0,0);let{data:e,error:c}=yield this.supabase.from("picks").select("picked_at").is("undone_at",null).gte("picked_at",n.toISOString()).order("picked_at",{ascending:!0});if(c)throw c;let h=new Map;for(let x=0;x<7;x++){let f=new Date(n);f.setDate(n.getDate()+x);let b=this.formatDateYMD(f);h.set(b,0)}(e||[]).forEach(x=>{let f=new Date(x.picked_at),b=this.formatDateYMD(f);h.set(b,(h.get(b)||0)+1)});let w=[];for(let x=0;x<7;x++){let f=new Date(n);f.setDate(n.getDate()+x);let b=this.formatDateYMD(f);w.push({date:b,count:h.get(b)||0,dayLabel:this.getDayLabel(f)})}return w}catch(t){return console.error("Error fetching daily pick activity:",t),[]}})}getTopPickersThisWeek(){return I(this,null,function*(){try{let{start:t,end:n}=this.getCurrentWeekRange(),{data:e,error:c}=yield this.supabase.from("picks").select("picked_by").is("undone_at",null).gte("picked_at",t.toISOString()).lte("picked_at",n.toISOString());if(c)throw c;let h=new Map;return(e||[]).forEach(x=>{let f=x.picked_by||"Unknown";h.set(f,(h.get(f)||0)+1)}),Array.from(h.entries()).map(([x,f])=>({picked_by:x,count:f})).sort((x,f)=>f.count-x.count).slice(0,5)}catch(t){return console.error("Error fetching top pickers:",t),[]}})}getCompletionTrend(){return I(this,null,function*(){try{let t=new Date,n=new Date(t);n.setDate(t.getDate()-13),n.setHours(0,0,0,0);let{data:e,error:c}=yield this.supabase.from("line_items").select(`
          id,
          total_qty_needed,
          orders!inner (
            status
          )
        `).eq("orders.status","active");if(c)throw c;let h=(e||[]).reduce((D,$)=>D+$.total_qty_needed,0);if(h===0)return[];let w=(e||[]).map(D=>D.id),{data:x,error:f}=yield this.supabase.from("picks").select("picked_at, qty_picked, line_item_id").in("line_item_id",w).is("undone_at",null).lte("picked_at",t.toISOString()).order("picked_at",{ascending:!0});if(f)throw f;let b=[],j=0;for(let D=0;D<14;D++){let $=new Date(n);$.setDate(n.getDate()+D);let N=new Date($);N.setHours(23,59,59,999),j=(x||[]).filter(z=>new Date(z.picked_at)<=N).reduce((z,gt)=>z+gt.qty_picked,0);let ht=h>0?Math.round(j/h*100):0;b.push({date:this.formatDateYMD($),percentage:Math.min(ht,100)})}return b}catch(t){return console.error("Error fetching completion trend:",t),[]}})}formatDateYMD(t){let n=t.getFullYear(),e=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0");return`${n}-${e}-${c}`}getDayLabel(t){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()]}getCurrentWeekRange(){let t=new Date,n=t.getDay(),e=new Date(t),c=n===0?6:n-1;e.setDate(t.getDate()-c),e.setHours(0,0,0,0);let h=new Date(e);return h.setDate(e.getDate()+6),h.setHours(23,59,59,999),{start:e,end:h}}static{this.\u0275fac=function(n){return new(n||i)(R(it))}}static{this.\u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Lt=()=>({sort:"due-date"}),mt=i=>["/orders",i];function Vt(i,s){if(i&1&&(r(0,"div",32)(1,"div",33)(2,"div",14)(3,"div",34)(4,"div")(5,"div",35),l(6),o(),r(7,"div",36),l(8),Z(9,"number"),o()(),r(10,"div",37),m(11,"i",38),o()()()()()),i&2){let t=s.$implicit,n=p();a(6),O(t.title),a(2),O(n.loading?"...":J(9,6,t.value)),a(2),d("ngClass",t.bgColor),a(),A(t.color),d("ngClass",t.icon)}}function Bt(i,s){i&1&&m(0,"i",47)}function Ft(i,s){i&1&&m(0,"i",48)}function $t(i,s){if(i&1&&(r(0,"span"),l(1),o()),i&2){let t=p().$implicit,n=p(2);a(),v(" - Due: ",n.utils.formatDate(t.due_date),"")}}function Mt(i,s){if(i&1&&(r(0,"a",49)(1,"div")(2,"span",50),l(3),o(),r(4,"span",51),l(5),o(),r(6,"div",52),l(7),g(8,$t,2,1,"span",19),o()(),r(9,"div",53)(10,"div",54),l(11),o(),r(12,"div",55),m(13,"div",56),o()()()),i&2){let t=s.$implicit,n=p(2);d("routerLink",G(9,mt,t.id)),a(3),v("SO-",t.so_number,""),a(),d("ngClass",n.utils.getDueDateBadgeClass(n.utils.getDueDateStatus(t.due_date).status)),a(),v(" ",n.utils.getDueDateStatus(t.due_date).label," "),a(2),v(" ",t.customer_name||t.tool_model||t.tools.length+" tool(s)"," "),a(),d("ngIf",t.due_date),a(3),v("",t.progress_percent,"%"),a(2),H("width",t.progress_percent,"%")}}function zt(i,s){if(i&1&&(r(0,"div",39)(1,"div",40)(2,"div",41),g(3,Bt,1,0,"i",42)(4,Ft,1,0,"i",43),r(5,"span",11),l(6),o()(),r(7,"a",44),l(8," View All "),m(9,"i",13),o()(),r(10,"div",14)(11,"div",45),g(12,Mt,14,11,"a",46),o()()()),i&2){let t=p();a(3),d("ngIf",t.overdueCount===0),a(),d("ngIf",t.overdueCount>0),a(),M("text-danger",t.overdueCount>0)("text-warning",t.overdueCount===0),a(),v(" ",t.overdueCount>0?t.overdueCount+" Overdue Order"+(t.overdueCount>1?"s":""):t.dueSoonOrders.length+" Order"+(t.dueSoonOrders.length>1?"s":"")+" Due Soon"," "),a(),d("queryParams",U(9,Lt)),a(5),d("ngForOf",t.dueSoonOrders.slice(0,5))}}function Ht(i,s){if(i&1&&(r(0,"div",71),l(1),o()),i&2){let t=p().$implicit;a(),O(t.description)}}function Gt(i,s){if(i&1){let t=T();r(0,"div",64)(1,"div",65)(2,"div",66)(3,"span",67),l(4),o(),r(5,"button",68),P("click",function(e){let c=y(t).$implicit,h=p(2);return C(h.copyPartNumber(c.part_number,e))}),m(6,"i",38),o()(),g(7,Ht,2,1,"div",69),o(),r(8,"span",70),l(9),o()()}if(i&2){let t=s.$implicit,n=p(2);a(4),O(t.part_number),a(2),d("ngClass",n.copiedPartNumber===t.part_number?"bi-check-lg text-success":"bi-copy"),a(),d("ngIf",t.description),a(2),v("",t.remaining," needed")}}function Wt(i,s){if(i&1&&(r(0,"p",72),l(1),o()),i&2){let t=p(2);a(),v(" +",t.itemsToOrder.length-5," more items ")}}function jt(i,s){if(i&1&&(r(0,"div",57)(1,"div",40)(2,"div",41),m(3,"i",58),r(4,"span",59),l(5),o()(),r(6,"a",60),l(7," View All "),m(8,"i",13),o()(),r(9,"div",14)(10,"p",61),l(11,"Parts with no stock available that still need to be picked"),o(),r(12,"div",45),g(13,Gt,10,4,"div",62),o(),g(14,Wt,2,1,"p",63),o()()),i&2){let t=p();a(5),S("",t.itemsToOrder.length," Part",t.itemsToOrder.length>1?"s":""," to Order"),a(8),d("ngForOf",t.itemsToOrder.slice(0,5)),a(),d("ngIf",t.itemsToOrder.length>5)}}function Nt(i,s){i&1&&(r(0,"div",73),l(1,"Loading..."),o())}function Yt(i,s){i&1&&(r(0,"div",74)(1,"p",75),l(2,"No active orders"),o(),r(3,"a",76),l(4,"Import an Order"),o()())}function Rt(i,s){if(i&1&&(r(0,"a",78)(1,"div",79)(2,"div")(3,"span",50),l(4),o(),r(5,"div",52),l(6),o()(),r(7,"div",80)(8,"div",81)(9,"span"),l(10),o(),r(11,"span",82),l(12),o()(),r(13,"div",55),m(14,"div",56),o()()()()),i&2){let t=s.$implicit;d("routerLink",G(8,mt,t.id)),a(4),v("SO-",t.so_number,""),a(2),v("",t.tools.length," tool(s)"),a(4),v("",t.progress_percent,"%"),a(2),S("",t.picked_items,"/",t.total_items,""),a(2),H("width",t.progress_percent,"%")}}function At(i,s){if(i&1&&(r(0,"div",45),g(1,Rt,15,10,"a",77),o()),i&2){let t=p();a(),d("ngForOf",t.activeOrders.slice(0,5))}}function qt(i,s){i&1&&(r(0,"div",73),l(1,"Loading..."),o())}function Xt(i,s){i&1&&(r(0,"div",73),l(1," No recent activity "),o())}function Ut(i,s){i&1&&m(0,"i",90)}function Zt(i,s){i&1&&m(0,"i",91)}function Jt(i,s){if(i&1&&(r(0,"div",84),g(1,Ut,1,0,"i",85)(2,Zt,1,0,"i",86),r(3,"div",87)(4,"p",88),l(5),o(),r(6,"p",89),l(7),o()(),r(8,"small",82),l(9),o()()),i&2){let t=s.$implicit,n=p(2);a(),d("ngIf",t.type==="pick_undo"),a(),d("ngIf",t.type!=="pick_undo"),a(2),M("text-danger",t.type==="pick_undo"),a(),O(t.message),a(2),S("",t.user," - SO-",t.so_number,""),a(2),O(n.utils.formatRelativeTime(t.timestamp))}}function Kt(i,s){if(i&1&&(r(0,"div"),g(1,Jt,10,8,"div",83),o()),i&2){let t=p();a(),d("ngForOf",t.activities.slice(0,8))}}function Qt(i,s){i&1&&(r(0,"div",92),m(1,"div",93),l(2," Loading chart... "),o())}function te(i,s){i&1&&(r(0,"div",92),l(1," No pick activity in the last 7 days "),o())}function ee(i,s){if(i&1&&m(0,"app-bar-chart",94),i&2){let t=p();d("data",t.dailyPicksData)("showValues",!0)}}function ie(i,s){i&1&&(r(0,"div",92),m(1,"div",93),l(2," Loading... "),o())}function ne(i,s){i&1&&(r(0,"div",92),l(1," No picks recorded this week "),o())}function ae(i,s){if(i&1&&m(0,"app-bar-chart",95),i&2){let t=p();d("data",t.topPickersData)("showValues",!0)}}function re(i,s){i&1&&(r(0,"div",92),m(1,"div",93),l(2," Loading chart... "),o())}function oe(i,s){i&1&&(r(0,"div",92),l(1," No active orders to track completion "),o())}function se(i,s){if(i&1&&m(0,"app-line-chart",96),i&2){let t=p();d("data",t.completionTrendData)("minValue",0)("maxValue",100)}}var we=(()=>{class i{constructor(t,n,e,c,h,w){this.ordersService=t,this.activityService=n,this.partsService=e,this.itemsToOrderService=c,this.chartsService=h,this.utils=w,this.orders=[],this.activities=[],this.parts=[],this.itemsToOrder=[],this.loading=!0,this.activityLoading=!0,this.itemsToOrderLoading=!0,this.stats=[],this.copiedPartNumber=null,this.dailyPicksData=[],this.topPickersData=[],this.completionTrendData=[],this.chartsLoading=!0,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.ordersService.orders$.subscribe(t=>{this.orders=t,this.updateStats()}),this.ordersService.loading$.subscribe(t=>{this.loading=t}),this.activityService.activities$.subscribe(t=>{this.activities=t}),this.activityService.loading$.subscribe(t=>{this.activityLoading=t}),this.partsService.parts$.subscribe(t=>{this.parts=t,this.updateStats()}),this.itemsToOrderService.items$.subscribe(t=>{this.itemsToOrder=t}),this.itemsToOrderService.loading$.subscribe(t=>{this.itemsToOrderLoading=t})),this.loadCharts()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}get activeOrders(){return this.orders.filter(t=>t.status==="active")}get completedOrders(){return this.orders.filter(t=>t.status==="complete")}get dueSoonOrders(){return this.activeOrders.filter(t=>this.utils.isDueSoon(t.due_date,3)).sort((t,n)=>t.due_date?n.due_date?new Date(t.due_date).getTime()-new Date(n.due_date).getTime():-1:1)}get overdueCount(){return this.dueSoonOrders.filter(t=>this.utils.getDueDateStatus(t.due_date).status==="overdue").length}copyPartNumber(t,n){return I(this,null,function*(){n.stopPropagation(),(yield this.utils.copyToClipboard(t))&&(this.copiedPartNumber=t,setTimeout(()=>{this.copiedPartNumber===t&&(this.copiedPartNumber=null)},2e3))})}updateStats(){let t=this.parts.reduce((c,h)=>c+h.total_needed,0),n=this.parts.reduce((c,h)=>c+h.total_picked,0),e=t-n;this.stats=[{title:"Active Orders",value:this.activeOrders.length,icon:"bi-clipboard-data",color:"text-primary",bgColor:"bg-primary bg-opacity-10"},{title:"Parts Remaining",value:e,icon:"bi-box-seam",color:"text-warning",bgColor:"bg-warning bg-opacity-10"},{title:"Parts Picked",value:n,icon:"bi-check-circle",color:"text-success",bgColor:"bg-success bg-opacity-10"},{title:"Completed Orders",value:this.completedOrders.length,icon:"bi-clock-history",color:"text-info",bgColor:"bg-info bg-opacity-10"}]}loadCharts(){return I(this,null,function*(){this.chartsLoading=!0;try{let[t,n,e]=yield Promise.all([this.chartsService.getLast7DaysPickActivity(),this.chartsService.getTopPickersThisWeek(),this.chartsService.getCompletionTrend()]);this.dailyPicksData=t.map(c=>({label:c.dayLabel,value:c.count})),this.topPickersData=n.map(c=>({label:c.picked_by,value:c.count})),this.completionTrendData=e.map(c=>({label:c.date,value:c.percentage}))}catch(t){console.error("Error loading charts:",t)}finally{this.chartsLoading=!1}})}static{this.\u0275fac=function(n){return new(n||i)(k(nt),k(at),k(rt),k(ot),k(pt),k(st))}}static{this.\u0275cmp=E({type:i,selectors:[["app-dashboard"]],standalone:!0,features:[L],decls:66,vars:18,consts:[[1,"page-header","d-flex","flex-wrap","justify-content-between","align-items-center","gap-3"],[1,"page-title"],[1,"page-subtitle"],[1,"row","g-3","mb-4"],["class","col-6 col-lg-3",4,"ngFor","ngForOf"],["class","card mb-4 alert-left-border border-start-warning",4,"ngIf"],["class","card mb-4 alert-left-border","style","border-left-color: var(--bs-warning) !important;",4,"ngIf"],[1,"row","g-4"],[1,"col-lg-6"],[1,"card","h-100"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"fw-semibold"],["routerLink","/orders",1,"btn","btn-sm","btn-outline-primary"],[1,"bi","bi-arrow-right","ms-1"],[1,"card-body"],["class","text-center py-4 text-muted",4,"ngIf"],["class","text-center py-4",4,"ngIf"],["class","list-group list-group-flush",4,"ngIf"],[1,"card-header"],[4,"ngIf"],[1,"mt-5","mb-4"],[1,"h5","fw-semibold","mb-3"],[1,"bi","bi-graph-up","me-2"],[1,"row","g-4","mb-4"],[1,"col-lg-8"],["class","text-center py-5 text-muted",4,"ngIf"],["orientation","vertical",3,"data","showValues",4,"ngIf"],[1,"col-lg-4"],["orientation","horizontal",3,"data","showValues",4,"ngIf"],[1,"col-12"],[1,"card"],[3,"data","minValue","maxValue",4,"ngIf"],[1,"col-6","col-lg-3"],[1,"card","stat-card","h-100"],[1,"d-flex","justify-content-between","align-items-start"],[1,"stat-label"],[1,"stat-value"],[1,"stat-icon",3,"ngClass"],[1,"bi",3,"ngClass"],[1,"card","mb-4","alert-left-border","border-start-warning"],[1,"card-header","bg-warning","bg-opacity-10","d-flex","justify-content-between","align-items-center"],[1,"d-flex","align-items-center"],["class","bi bi-exclamation-triangle text-warning me-2",4,"ngIf"],["class","bi bi-exclamation-circle text-danger me-2",4,"ngIf"],["routerLink","/orders",1,"btn","btn-sm","btn-outline-secondary",3,"queryParams"],[1,"list-group","list-group-flush"],["class","list-group-item list-group-item-action d-flex justify-content-between align-items-center",3,"routerLink",4,"ngFor","ngForOf"],[1,"bi","bi-exclamation-triangle","text-warning","me-2"],[1,"bi","bi-exclamation-circle","text-danger","me-2"],[1,"list-group-item","list-group-item-action","d-flex","justify-content-between","align-items-center",3,"routerLink"],[1,"fw-medium"],[1,"badge","ms-2",3,"ngClass"],[1,"small","text-muted"],[1,"text-end",2,"width","100px"],[1,"small","fw-medium"],[1,"progress",2,"height","6px"],[1,"progress-bar"],[1,"card","mb-4","alert-left-border",2,"border-left-color","var(--bs-warning) !important"],[1,"bi","bi-cart","text-warning","me-2"],[1,"fw-semibold","text-warning"],["routerLink","/items-to-order",1,"btn","btn-sm","btn-outline-secondary"],[1,"small","text-muted","mb-3"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],["class","small text-muted text-center mt-2 mb-0",4,"ngIf"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"text-truncate"],[1,"d-flex","align-items-center","gap-2"],[1,"font-mono","fw-medium"],["title","Copy Part Number",1,"btn","btn-sm","btn-ghost","p-0","text-muted",3,"click"],["class","small text-muted text-truncate",4,"ngIf"],[1,"badge","bg-warning","text-dark","rounded-pill","ms-2"],[1,"small","text-muted","text-truncate"],[1,"small","text-muted","text-center","mt-2","mb-0"],[1,"text-center","py-4","text-muted"],[1,"text-center","py-4"],[1,"text-muted","mb-3"],["routerLink","/import",1,"btn","btn-primary"],["class","list-group-item list-group-item-action",3,"routerLink",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action",3,"routerLink"],[1,"d-flex","justify-content-between","align-items-center"],[1,"text-end",2,"width","120px"],[1,"d-flex","justify-content-between","small","mb-1"],[1,"text-muted"],["class","d-flex align-items-start mb-3",4,"ngFor","ngForOf"],[1,"d-flex","align-items-start","mb-3"],["class","bi bi-arrow-counterclockwise text-danger me-2 mt-1",4,"ngIf"],["class","bi bi-check-circle-fill text-success me-2 mt-1",4,"ngIf"],[1,"flex-grow-1"],[1,"mb-0","small"],[1,"text-muted","small","mb-0"],[1,"bi","bi-arrow-counterclockwise","text-danger","me-2","mt-1"],[1,"bi","bi-check-circle-fill","text-success","me-2","mt-1"],[1,"text-center","py-5","text-muted"],[1,"spinner-border","spinner-border-sm","me-2"],["orientation","vertical",3,"data","showValues"],["orientation","horizontal",3,"data","showValues"],[3,"data","minValue","maxValue"]],template:function(n,e){n&1&&(r(0,"div")(1,"div",0)(2,"div")(3,"h1",1),l(4,"Dashboard"),o(),r(5,"p",2),l(6,"Overview of your pick list progress"),o()()(),r(7,"div",3),g(8,Vt,12,8,"div",4),o(),g(9,zt,13,10,"div",5)(10,jt,15,4,"div",6),r(11,"div",7)(12,"div",8)(13,"div",9)(14,"div",10)(15,"span",11),l(16,"Active Orders"),o(),r(17,"a",12),l(18," View All "),m(19,"i",13),o()(),r(20,"div",14),g(21,Nt,2,0,"div",15)(22,Yt,5,0,"div",16)(23,At,2,1,"div",17),o()()(),r(24,"div",8)(25,"div",9)(26,"div",18)(27,"span",11),l(28,"Recent Activity"),o()(),r(29,"div",14),g(30,qt,2,0,"div",15)(31,Xt,2,0,"div",15)(32,Kt,2,1,"div",19),o()()()(),r(33,"div",20)(34,"h2",21),m(35,"i",22),l(36," This Week's Activity "),o()(),r(37,"div",23)(38,"div",24)(39,"div",9)(40,"div",18)(41,"span",11),l(42,"Last 7 Days Pick Activity"),o()(),r(43,"div",14),g(44,Qt,3,0,"div",25)(45,te,2,0,"div",25)(46,ee,1,2,"app-bar-chart",26),o()()(),r(47,"div",27)(48,"div",9)(49,"div",18)(50,"span",11),l(51,"Top Pickers This Week"),o()(),r(52,"div",14),g(53,ie,3,0,"div",25)(54,ne,2,0,"div",25)(55,ae,1,2,"app-bar-chart",28),o()()()(),r(56,"div",7)(57,"div",29)(58,"div",30)(59,"div",18)(60,"span",11),l(61,"Pick Completion Trend (Last 14 Days)"),o()(),r(62,"div",14),g(63,re,3,0,"div",25)(64,oe,2,0,"div",25)(65,se,1,3,"app-line-chart",31),o()()()()()),n&2&&(a(8),d("ngForOf",e.stats),a(),d("ngIf",!e.loading&&e.dueSoonOrders.length>0),a(),d("ngIf",!e.itemsToOrderLoading&&e.itemsToOrder.length>0),a(11),d("ngIf",e.loading),a(),d("ngIf",!e.loading&&e.activeOrders.length===0),a(),d("ngIf",!e.loading&&e.activeOrders.length>0),a(7),d("ngIf",e.activityLoading),a(),d("ngIf",!e.activityLoading&&e.activities.length===0),a(),d("ngIf",!e.activityLoading&&e.activities.length>0),a(12),d("ngIf",e.chartsLoading),a(),d("ngIf",!e.chartsLoading&&e.dailyPicksData.length===0),a(),d("ngIf",!e.chartsLoading&&e.dailyPicksData.length>0),a(7),d("ngIf",e.chartsLoading),a(),d("ngIf",!e.chartsLoading&&e.topPickersData.length===0),a(),d("ngIf",!e.chartsLoading&&e.topPickersData.length>0),a(8),d("ngIf",e.chartsLoading),a(),d("ngIf",!e.chartsLoading&&e.completionTrendData.length===0),a(),d("ngIf",!e.chartsLoading&&e.completionTrendData.length>0))},dependencies:[F,K,V,B,Q,et,tt,lt,ct],encapsulation:2})}}return i})();export{we as DashboardComponent};
